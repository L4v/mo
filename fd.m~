function [x, y] = fd(u, v, w, xa, xb, ya, yb, n)
% eq: y(x)'' = u(x) + v(x).*y(x) + w(x).*y'(x)

% u, v, w matrice, mozda f-handle?

%  v >= 0 i h <= 2/max_x(|w(x)|)

% a = 1 + h/2 * w
% d = -2 - h^2 * v
% c = 1 - h/2 * w
% e = h^2 * u
% resava Ay = b

h = (xb - xa) / n;
i = 0:n;
x = xa + i * h;
x(1) = xa;
x(end) = xb;
% pretpostavlja se da su prosledjene u,v,w dobre velicine
%a = zeros(n+1); d = zeros(n+1); c = zeros(n+1); e = zeros(n+1);
a = 1 + h/2 .* w(x);
d = -2 - h^2 .* v(x);
c = 1 - h/2 .* w(x);
e = h^2 .* u(x);

% tridijagonalna matrica A



A = zeros(n-1) + diag(d(1:n-1)) + diag(a(2:n-1), -1) + diag(c(1:n-2), 1)
b = zeros(n-1, 1);
b(1) = e(1) - a(1) * ya;
b(n-1) = e(n-1) - c(n-1) * yb;
b(2:n-2) = e(2:n-2);
b
x0 = zeros(n-1, 1);
x0(:) = xa;
y = zeros(n+1, 1);
y(1) = ya;
y(end) = yb;

y(2:n) = A\b;%jacobi(A, b, x0, 100, 10^-5);
end